<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>折腾校园卡</title>
    <link href="/2022/04/23/0423/"/>
    <url>/2022/04/23/0423/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>先挖个坑，期中考完再填</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Dailycheckin实现网易云+百度贴吧自动签到</title>
    <link href="/2022/03/22/0322/"/>
    <url>/2022/03/22/0322/</url>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Dailycheckin"><a href="#Dailycheckin" class="headerlink" title="Dailycheckin"></a>Dailycheckin</h1><blockquote><p>环境：CentOS、Python3<br>某日，余上网冲浪时，闻此脚本，大喜，因戏之<br>该脚本支持多个网页的签到，提供多种推送，非常适合我这种又懒又想白嫖的人</p></blockquote><h1 id="一、本地验证"><a href="#一、本地验证" class="headerlink" title="一、本地验证"></a>一、本地验证</h1><blockquote><p>均在dailycheckin文件夹下操作</p></blockquote><h2 id="1、安装依赖包"><a href="#1、安装依赖包" class="headerlink" title="1、安装依赖包"></a>1、安装依赖包</h2> <figure class="highlight moonscript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs moonscript"><span class="hljs-name">D</span>:\Pyfile\dailycheckin&gt; pip3 install dailycheckin <span class="hljs-comment">--upgrade -t .</span><br></code></pre></div></td></tr></table></figure><h2 id="2、新建index-py文件"><a href="#2、新建index-py文件" class="headerlink" title="2、新建index.py文件"></a>2、新建index.py文件</h2> <figure class="highlight clean"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs clean"># -*- coding: utf<span class="hljs-number">-8</span> -*-<br><span class="hljs-keyword">from</span> dailycheckin.main <span class="hljs-keyword">import</span> checkin<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    checkin()<br></code></pre></div></td></tr></table></figure><h2 id="3、修改json配置文件"><a href="#3、修改json配置文件" class="headerlink" title="3、修改json配置文件"></a>3、修改json配置文件</h2><p> 在dailycheckin文件夹中，新建config文件夹，里面新建config.json文件</p><ul><li>推送：我只用到了server酱TURBO，所以只留下了SENDKEY，其余删除，可以去官网(<a href="https://sitoi.gitee.io/dailycheckin/settings">https://sitoi.gitee.io/dailycheckin/settings</a>) 选择自己需要的项</li><li>网页：只留下 网易云音乐 和 百度贴吧 ，其余功能可以自行添加 </li></ul> <figure class="highlight json"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;SENDKEY&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XXX&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;COOLPUSHQQ&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;COOLPUSHWX&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;COOLPUSHEMAIL&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-keyword">true</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;MERGE_PUSH&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;True&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;MUSIC163&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;password&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XXX&quot;</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;phone&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XXX&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;TIEBA&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>    <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;cookie&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;XXX&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></div></td></tr></table></figure><p> XXX需要替换为个人信息</p><h2 id="4、测试"><a href="#4、测试" class="headerlink" title="4、测试"></a>4、测试</h2><p> 运行index.py,看到类似以下内容表示各项无误</p> <figure class="highlight nestedtext"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs nestedtext"><span class="hljs-attribute">当前时间</span><span class="hljs-punctuation">:</span> <span class="hljs-string">2022-03-22 14:36:25</span><br><span class="hljs-attribute">当前版本</span><span class="hljs-punctuation">:</span> <span class="hljs-string">0.3.7</span><br><span class="hljs-attribute">使用配置文件路径</span><span class="hljs-punctuation">:</span> <span class="hljs-string">D:\Pyfile\dailycheckin\config\config.json</span><br><br><span class="hljs-attribute">---------- 本次执行签到任务如下 ----------</span><br><span class="hljs-attribute"></span><br><span class="hljs-attribute">「网易云音乐」账号数</span><span class="hljs-punctuation"> :</span> <span class="hljs-string">1</span><br><span class="hljs-attribute">「百度贴吧」账号数</span><span class="hljs-punctuation"> :</span> <span class="hljs-string">1</span><br><br><br><span class="hljs-attribute">----------开始执行「网易云音乐」签到----------</span><br><span class="hljs-attribute">第 1 个账号</span><span class="hljs-punctuation">:</span> <span class="hljs-string">✅✅✅✅✅</span><br><span class="hljs-attribute">----------开始执行「百度贴吧」签到----------</span><br><span class="hljs-attribute">第 1 个账号</span><span class="hljs-punctuation">:</span> <span class="hljs-string">✅✅✅✅✅</span><br><br><br>server 酱 Turbo 推送开始<br></code></pre></div></td></tr></table></figure><h1 id="二、云端安装"><a href="#二、云端安装" class="headerlink" title="二、云端安装"></a>二、云端安装</h1><blockquote><p>进入脚本官网(<a href="https://sitoi.gitee.io/dailycheckin/">https://sitoi.gitee.io/dailycheckin/</a>)<br>左侧 &gt; 安装，选择”云函数”,由于我没有找到腾讯云云函数的终端在哪里，所以选择使用云服务器(CentOS 7)</p></blockquote><h2 id="1、Xshell连接服务器，进入目标文件夹-安装依赖包"><a href="#1、Xshell连接服务器，进入目标文件夹-安装依赖包" class="headerlink" title="1、Xshell连接服务器，进入目标文件夹,安装依赖包"></a>1、Xshell连接服务器，进入目标文件夹,安装依赖包</h2> <figure class="highlight awk"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs awk">[root@VM-<span class="hljs-number">16</span>-<span class="hljs-number">10</span>-centos <span class="hljs-regexp">/]# cd /</span>root<span class="hljs-regexp">/pyfile/</span>dailycheckin<br>[root@VM-<span class="hljs-number">16</span>-<span class="hljs-number">10</span>-centos dailycheckin]<span class="hljs-comment"># pip3 install dailycheckin --upgrade -t .</span><br></code></pre></div></td></tr></table></figure><p> 同时将本地的index.py和config/config.json也传到文件夹里</p><h2 id="2、设置定时执行"><a href="#2、设置定时执行" class="headerlink" title="2、设置定时执行"></a>2、设置定时执行</h2><blockquote><p>使用crond命令<br>参考：<a href="https://www.cnblogs.com/yangjisen/p/13171918.html">https://www.cnblogs.com/yangjisen/p/13171918.html</a></p></blockquote> <figure class="highlight bash"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs bash">crontab -l  <span class="hljs-comment"># 查看当前系统中的定时任务列表</span><br>crontab -e  <span class="hljs-comment"># 对crontab进行编辑</span><br><span class="hljs-built_in">which</span> python3  <span class="hljs-comment"># 查看python3的路径</span><br></code></pre></div></td></tr></table></figure><p> 每天早上7点30自动执行，在crontab文件中添加一行：<br> <figure class="highlight basic"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs basic"><span class="hljs-symbol">30 </span><span class="hljs-number">7</span> * * * /<span class="hljs-keyword">usr</span>/bin/python3 /root/pyfile/dailycheckin/index.py<br></code></pre></div></td></tr></table></figure></p><h1 id="三、修改配置文件路径"><a href="#三、修改配置文件路径" class="headerlink" title="三、修改配置文件路径"></a>三、修改配置文件路径</h1><h2 id="1、错误"><a href="#1、错误" class="headerlink" title="1、错误"></a>1、错误</h2><blockquote><p>配置完成后，第二天早上我发现并没有执行，感到很奇怪，又打开Xshell直接执行了该命令</p></blockquote> <figure class="highlight gradle"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs gradle">[root@VM-<span class="hljs-number">16</span>-<span class="hljs-number">10</span>-centos ~]# python3 <span class="hljs-regexp">/root/</span>pyfile<span class="hljs-regexp">/dailycheckin/i</span>ndex.py<br></code></pre></div></td></tr></table></figure><p> 报错：<br> <figure class="highlight arcade"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs arcade">当前时间: <span class="hljs-number">2022</span><span class="hljs-number">-03</span><span class="hljs-number">-22</span> <span class="hljs-number">15</span>:<span class="hljs-number">15</span>:<span class="hljs-number">41</span><br>当前版本: <span class="hljs-number">0.3</span><span class="hljs-number">.7</span><br>未找到 config.json 配置文件<br>请在下方任意目录中添加「config.json」文件:<br><span class="hljs-regexp">/ql/</span>scripts<br>/root<br>/<br><span class="hljs-regexp">/root/</span>config<br>/config<br></code></pre></div></td></tr></table></figure><br> 猜测是在根目录下执行，且程序读取config.json采用的是相对路径，所以找不到配置文件。把文件放入/root/config/中，发现在根目录可以执行，但定时任务无法执行(未发现原因)，于是干脆修改代码，使用绝对路径</p><h2 id="2、解决方法"><a href="#2、解决方法" class="headerlink" title="2、解决方法"></a>2、解决方法</h2><p> 在dailycheckin/dailycheckin/main.py中发现如下代码：<br> <figure class="highlight python"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">check_config</span>(<span class="hljs-params">task_list</span>):<br>   config_path = <span class="hljs-literal">None</span><br>   config_path_list = []<br>   <span class="hljs-keyword">for</span> one_path <span class="hljs-keyword">in</span> [<br>       <span class="hljs-string">&quot;/ql/scripts/config.json&quot;</span>,<br>       <span class="hljs-string">&quot;config.json&quot;</span>,<br>       <span class="hljs-string">&quot;../config.json&quot;</span>,<br>       <span class="hljs-string">&quot;./config/config.json&quot;</span>,<br>       <span class="hljs-string">&quot;../config/config.json&quot;</span>,<br>       <span class="hljs-string">&quot;/config.json&quot;</span>,<br>   ]:<br></code></pre></div></td></tr></table></figure><br> 直接在列表中添加 <code> &quot;/root/pyfile/dailycheckin/config/config.json&quot;,</code></p><p> 即之前存放的路径，仍使用 一.3 的配置即可</p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
